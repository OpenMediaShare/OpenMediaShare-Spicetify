(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var n,r,c,s,e;async function t(e){null!=e&&e.data&&(c.video.title=e.data.item.name,e.data.item.artists)&&(c.video.creator=e.data.item.artists.map(e=>e.name).join(", "),c.video.thumbnail="https://i.scdn.co/image/"+e.data.item.metadata.image_url.split(":")[2],c.video.url="https://waterwolf.net/404",c.video.color=Spicetify.colorExtractor(e.data.item.metadata.image_url),await fetch(n+"/media/all",{headers:r,method:"POST",body:JSON.stringify(c)}))}function d(e){var t=Math.round(Math.floor(e/60));let a=Math.round(e-60*t);return[t,a=a<10?"0"+a:a]}n="http://localhost:9494/api",r={Accept:"application/json","Content-Type":"application/json"},c={video:{creator:"OpenMediaShare",title:"Waiting For Playback",views:void 0,likes:void 0,thumbnail:"https://cdn.discordapp.com/avatars/877743969503682612/a90d74f19a4e5b2319303f8c90b85405.webp?size=240",url:"https://waterwolf.net",color:"WHITE"},time:{curruntTime:0,totalTime:0,timePercent:0,formattedTime:"0w0"},auth:{name:"spicetify",uuid:crypto.randomUUID()}},s=Date.now(),e=async function(){await fetch(n+"/auth/openSession",{headers:r,method:"POST",body:JSON.stringify(c)}),Spicetify.Player.addEventListener("onplaypause",async e=>{""===c.video.title&&t(e),await fetch(n+"/auth/main",{headers:r,method:"POST",body:JSON.stringify(c)}),console.log("Play Pause")}),Spicetify.Player.addEventListener("songchange",async e=>{console.log(null==e?void 0:e.data),t(e)}),Spicetify.Player.addEventListener("onprogress",async e=>{var t,a,i,o;""===c.video.title&&(Spicetify.Player.pause(),Spicetify.Player.play()),console.log((Date.now()-s)/1e3),(Date.now()-s)/1e3<1||(t=Spicetify.Player.getDuration()/1e3,i=d(a=Spicetify.Player.getProgress()/1e3),o=d(t),console.log(`${i[0]}:${i[1]} / ${o[0]}:`+o[1]),c.time={curruntTime:a,totalTime:t,timePercent:a/t*100,formattedTime:`${i[0]}:${i[1]} / ${o[0]}:`+o[1]},await fetch(n+"/media/all",{headers:r,method:"POST",body:JSON.stringify(c)}),s=Date.now())})},(async()=>{await e()})()})();